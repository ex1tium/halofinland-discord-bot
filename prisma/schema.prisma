// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model BotUser {
  userId            Int         @id @default(autoincrement()) @map("userId")
  discordUserId     String      @unique
  gamerTag          String?
  name              String?
  allowStatsLogging Int         @default(0)
  HaloStats         HaloStats[]

  @@map("user")
}

model Tweets {
  newest_id       String   @unique
  oldest_id       String
  ratelimit_reset Int
  lastUpdated     DateTime

  @@map("tweets")
}

model Tweet {
  id         String   @id
  text       String
  created_at DateTime
  author_id  String

  @@map("tweet")
}

model HaloStats {
  id                          Int                        @id
  serviceRecord               HaloInfiniteServiceRecord? @relation(fields: [haloInfiniteServiceRecordId], references: [id])
  csrs                        HaloInfiniteCsrs?          @relation(fields: [haloInfiniteCsrsId], references: [id])
  BotUser                     BotUser                    @relation(fields: [botUserUserId], references: [userId])
  botUserUserId               Int
  haloInfiniteServiceRecordId Int
  haloInfiniteCsrsId          Int
}

model HaloInfiniteServiceRecord {
  // botUser       BotUser @relation(fields: [botUserUserId], references: [userId])
  id          Int  @id
  // botUserUserId Int  @id
  dataFromApi Json
  HaloStats HaloStats[]
  
  @@map("hi_service_record")
}

model HaloInfiniteCsrs {
  id          Int         @id
  dataFromApi Json
  HaloStats   HaloStats[]

  @@map("hi_csrs")
}
